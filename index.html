<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Master Check - NovaBeauty</title>
    <style>
        /* ESTILOS MODERNOS E DARK MODE */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { font-family: -apple-system, system-ui, sans-serif; background: #0f172a; color: white; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background: #1e293b; width: 100%; max-width: 400px; padding: 30px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); text-align: center; border: 1px solid #334155; display: none; }
        h2 { margin-bottom: 8px; color: #f8fafc; font-size: 22px; }
        p.desc { color: #94a3b8; font-size: 14px; margin-bottom: 24px; line-height: 1.4; }
        input { width: 100%; padding: 16px; font-size: 16px; border: 2px solid #334155; border-radius: 12px; margin-bottom: 12px; text-align: center; background: #0f172a; color: white; transition: 0.3s; }
        input:focus { border-color: #38bdf8; }
        button { width: 100%; padding: 16px; background: #38bdf8; color: #0f172a; border: none; border-radius: 12px; font-weight: 800; cursor: pointer; text-transform: uppercase; transition: 0.2s; }
        button:active { transform: scale(0.98); }
        .btn-reg { background: none; border: 1px solid #334155; color: #94a3b8; margin-top: 10px; font-size: 13px; }
        #resultado { margin-top: 20px; padding: 15px; border-radius: 12px; display: none; font-weight: 600; line-height: 1.5; font-size: 15px; }
        .sucesso { background: #064e3b; color: #34d399; border: 1px solid #065f46; }
        .erro { background: #450a0a; color: #f87171; border: 1px solid #7f1d1d; }
        .logout { margin-top: 25px; font-size: 11px; color: #64748b; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

    <div id="telaLogin" class="container" style="display: block;">
        <div style="font-size: 45px; margin-bottom: 10px;">üîê</div>
        <h2>Acesso Afiliados</h2>
        <p class="desc">NovaBeauty Serum - Consulta Logzz</p>
        <input type="text" id="loginUser" placeholder="Usu√°rio">
        <input type="password" id="loginPass" placeholder="Senha">
        <button onclick="fazerLogin()">ENTRAR NO SISTEMA</button>
        <button class="btn-reg" onclick="mostrarTela('telaCadastro')">SOLICITAR NOVO ACESSO</button>
    </div>

    <div id="telaCadastro" class="container">
        <div style="font-size: 45px; margin-bottom: 10px;">üë§</div>
        <h2>Novo Cadastro</h2>
        <p class="desc">Informe seu nome e o usu√°rio que deseja para aprova√ß√£o.</p>
        <input type="text" id="regNome" placeholder="Seu Nome Completo">
        <input type="text" id="regUser" placeholder="Usu√°rio que deseja usar">
        <button onclick="enviarSolicitacao()" style="background: #25d366; color: white;">PEDIR ACESSO NO WHATSAPP</button>
        <p onclick="mostrarTela('telaLogin')" style="margin-top: 15px; cursor: pointer; color: #94a3b8; font-size: 14px;">Voltar ao Login</p>
    </div>

    <div id="telaApp" class="container">
        <div style="font-size: 40px; margin-bottom: 10px;">üöö</div>
        <h2>Consultar Entrega</h2>
        <p class="desc">Verifique a disponibilidade Logzz para o cliente.</p>
        <input type="tel" id="cepInput" placeholder="00000-000" maxlength="9">
        <button onclick="verificarCep()">VERIFICAR AGORA</button>
        <div id="resultado"></div>
        <p class="logout" onclick="sair()">Sair da conta / Bloquear App</p>
    </div>

<script>
    // CONFIGURA√á√ïES DO GITHUB -
    const GITHUB_USER = "thcompany011-crypto";
    const REPO_NAME = "Ferramentas-Ceps";
    const WHATS_ALEX = "5562991054774"; 

    let db = { acessos: [], cidades: [], bloqueados: [] };

    // FUN√á√ÉO PARA BUSCAR DADOS DO GITHUB
    async function carregarDados() {
        const urlBase = `https://raw.githubusercontent.com/${GITHUB_USER}/${REPO_NAME}/main/`;
        try {
            const [resAcc, resCit, resBlo] = await Promise.all([
                fetch(urlBase + "acessos.json"),
                fetch(urlBase + "cidades-atendidas.json"),
                fetch(urlBase + "ceps-bloqueados.json")
            ]);
            db.acessos = await resAcc.json();
            db.cidades = await resCit.json();
            db.bloqueados = await resBlo.json();
        } catch (e) {
            console.error("Erro ao carregar arquivos do GitHub:", e);
        }
    }

    // L√ìGICA DE LOGIN COM USU√ÅRIO E SENHA -
    async function fazerLogin() {
        await carregarDados();
        const userIn = document.getElementById('loginUser').value;
        const passIn = document.getElementById('loginPass').value;
        
        const validUser = db.acessos.find(u => u.usuario === userIn && u.senha === passIn);
        
        if (validUser) {
            localStorage.setItem('nova_auth_active', validUser.usuario);
            mostrarTela('telaApp');
        } else {
            alert("Usu√°rio ou senha incorretos! Pe√ßa acesso ao Alex.");
        }
    }

    // SOLICITA√á√ÉO DE ACESSO VIA WHATSAPP -
    function enviarSolicitacao() {
        const nome = document.getElementById('regNome').value;
        const userReq = document.getElementById('regUser').value;
        if(!nome || !userReq) return alert("Preencha todos os campos!");
        
        const msg = encodeURIComponent(`Ol√° Alex! Quero acesso √† ferramenta NovaBeauty.\n\nüë§ Nome: ${nome}\nüÜî Usu√°rio: ${userReq}`);
        window.open(`https://wa.me/${WHATS_ALEX}?text=${msg}`, '_blank');
    }

    // L√ìGICA DE CONSULTA POR FAIXA NUM√âRICA (CORRE√á√ÉO DO ERRO)
    async function verificarCep() {
        const cepRaw = document.getElementById('cepInput').value.replace(/\D/g, '');
        const resDiv = document.getElementById('resultado');
        
        if(cepRaw.length !== 8) return alert("Digite um CEP v√°lido com 8 n√∫meros.");
        const cepNum = parseInt(cepRaw);

        // Garante que os dados est√£o carregados
        if(db.cidades.length === 0) await carregarDados();

        // 1. Verifica Bloqueio Primeiro
        const bloqueado = db.bloqueados.some(b => cepNum >= b.inicio && cepNum <= b.fim);
        
        // 2. Verifica se a Cidade √© Atendida
        const atendida = db.cidades.find(c => cepNum >= c.inicio && cepNum <= c.fim);

        resDiv.style.display = "block";

        if (bloqueado) {
            resDiv.innerHTML = "‚ùå <strong>CEP BLOQUEADO</strong><br>Regi√£o com restri√ß√£o log√≠stica na Logzz. Venda via Braip.";
            resDiv.className = "erro";
        } else if (atendida) {
            resDiv.innerHTML = `‚úÖ <strong>ENTREGA DISPON√çVEL!</strong><br>Pagamento na entrega dispon√≠vel para ${atendida.cidade}.`;
            resDiv.className = "sucesso";
        } else {
            resDiv.innerHTML = "‚ùå <strong>REGI√ÉO N√ÉO ATENDIDA</strong><br>Logzz n√£o cobre este CEP. Use pagamento antecipado.";
            resDiv.className = "erro";
        }
    }

    // NAVEGA√á√ÉO ENTRE TELAS
    function mostrarTela(id) {
        document.querySelectorAll('.container').forEach(c => c.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }

    function sair() { localStorage.clear(); location.reload(); }

    // VERIFICA SESS√ÉO AO ABRIR
    if(localStorage.getItem('nova_auth_active')) {
        carregarDados().then(() => mostrarTela('telaApp'));
    }

    // M√ÅSCARA DE CEP AUTOM√ÅTICA
    document.getElementById('cepInput').addEventListener('input', e => {
        let x = e.target.value.replace(/\D/g, '').match(/(\d{0,5})(\d{0,3})/);
        e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2];
    });
</script>
</body>
</html>

